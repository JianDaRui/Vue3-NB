# 观察者模式与代理模式

## 观察者模式

Vue2内部通过观察者模式处理数据与依赖的关系：

观察者模式的特点：

- 一对多。多个对象之间存在一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于他的对象都得到通知并被自动更新，

- 降低目标数据与依赖之间的耦合关系
- 属于行为型设计模式

在Vue2中 数据就是我们要观察的对象，Watcher就是依赖，而Dep只是负责对watcher的收集和派发。

有意思的是，在Vue2中watcher也是目标数据。它与Dep是一种多对多的关系，而不是一对多。

```js
// 
class Observe {
}
class Dep {
}
class Watcher {
}
```



## 代理模式

Vue3采用的是基于Proxy代理模式。

代理模式属于设计模式中的一种结构型模式。通过代理模式我们可以基于原始对象，创建一个与之拥有相同接口的代理对象，在代理对象的接口中，我们可以做一些扩展性的操作，但是并不破坏原始对象。

当我们需要对原始对象的访问做一些控制或者加强时，就可以使用代理模式。

代理模式的特点：

- 可以控制外部对于原始对象的访问，可以代表原始对象，通过代理对象以控制对原始对象的访问。
- 职责清晰、高扩展性、智能化
  - 代理对象用于控制外界对原始对象的访问
  - 可以借助代理对象，增强或扩展接口功能
  - 
- 属于结构型设计模式
- 例：正/反向代理、静/动态代理。

<img :src="$withBase('/img/proxy.jpg')" width="600" height="auto" alt="代理模式">
